
# Отчет по тестированию API

## 1. Протестированные эндпоинты

### 1.1. Аутентификация

#### `POST /send_reminder_email/`
- **Назначение**: Отправка напоминания на email
- **Метод**: POST
- **Требуемая аутентификация**: Да
- **Параметры запроса**:
  - email (строка, обязательно)
- **Успешный ответ**:
  ```json
  {
    "status": "success",
    "message": "Напоминание отправлено"
  }
  ```
- **Статус тестирования**: Успешно

### 3.2. Работа с данными сна

#### `POST /sleep-records-from-csv/`
- **Назначение**: Импорт записей о сне из CSV-файла
- **Метод**: POST
- **Content-Type**: multipart/form-data
- **Параметры запроса**:
  - csv_file (файл, обязательно, формат .csv)
- **Успешный ответ**:
  ```json
  {
    "task_id": "550e8400-e29b-41d4-a716-446655440000"
  }
  ```
- **Ошибки**:
  - 400: Некорректный формат файла
  - 401: Пользователь не аутентифицирован
- **Статус тестирования**: Успешно

#### `GET /sleep-statistics-show/`
- **Назначение**: Получение статистики сна
- **Метод**: GET
- **Параметры запроса**:
  - page_size (опционально, по умолчанию 7)
  - after (опционально, курсор пагинации)
  - before (опционально, курсор пагинации)
- **Успешный ответ (JSON)**:
  ```json
  {
    "has_next": true,
    "has_previous": false,
    "graph_data": {
      "dates": [...],
      "durations": [...],
      "efficiency": [...]
    },
    "metric": {
      "chronotype": {...},
      "sleep_regularity": {...},
      "avg_sleep_duration": 420,
      "calories_burned": 320,
      "sleep_efficiency": 85.5
    }
  }
  ```
- **Статус тестирования**: Успешно

#### `GET /sleep-history/`
- **Назначение**: Получение истории сна
- **Метод**: GET
- **Параметры запроса**:
  - page_size (опционально, по умолчанию 7)
  - after (опционально, курсор пагинации)
  - before (опционально, курсор пагинации)
- **Успешный ответ (JSON)**:
  ```json
  {
    "has_next": true,
    "has_previous": false,
    "graph_data_json": {
      "dates": [...],
      "efficiency": [...],
      "phases": [...]
    }
  }
  ```
- **Статус тестирования**: Успешно

## 4. Тестирование производительности

### 4.1. Время отклика
| Эндпоинт | Среднее время отклика | Статус           |
|----------|-----------------------|------------------|
| GET /sleep-statistics-show/ | 450 мс                | В пределах нормы |
| GET /sleep-history/ | 380 мс                | В пределах нормы |
| POST /sleep-records-from-csv/ | 500 мс                | В пределах нормы |

### 4.2. Нагрузочное тестирование
- **Методология**: 100 запросов с 10 параллельными потоками
- **Результаты**:
  - Успешных запросов: 100%
  - Среднее время отклика: 520 мс
  - 95-й процентиль: 780 мс

## 5. Обработка ошибок

### 5.1. Протестированные сценарии ошибок
1. **Неавторизованный доступ**
   - **Ожидаемый результат**: 401 Unauthorized
   - **Фактический результат**: Соответствует ожидаемому

2. **Некорректные параметры запроса**
   - **Пример**: Неверный формат даты
   - **Ожидаемый результат**: 400 Bad Request с описанием ошибки
   - **Фактический результат**: Соответствует ожидаемому

3. **Доступ к несуществующему ресурсу**
   - **Ожидаемый результат**: 404 Not Found
   - **Фактический результат**: Соответствует ожидаемому

## 6. Безопасность

### 6.1. Аутентификация
- Используется сессионная аутентификация Django
- Защита от CSRF-атак
- Ограничение попыток входа

### 6.2. Валидация входных данных
- Проверка типов данных
- Валидация форматов (даты, email и т.д.)
- Очистка от потенциально опасных данных


